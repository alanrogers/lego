<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>lego: parse.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">lego
   &#160;<span id="projectnumber">0.1</span>
   </div>
   <div id="projectbrief">Lego is a system of programs written in C and Python, which uses counts of nucleotide site patterns to infer thehistoryofpopulationsize,subdivision,andgeneflow.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">parse.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Parse a .lgo file.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;popnodetab.h&quot;</code><br />
<code>#include &quot;lblndx.h&quot;</code><br />
<code>#include &quot;misc.h&quot;</code><br />
<code>#include &quot;parse.h&quot;</code><br />
<code>#include &quot;parstore.h&quot;</code><br />
<code>#include &quot;popnode.h&quot;</code><br />
<code>#include &quot;<a class="el" href="tokenizer_8h_source.html">tokenizer.h</a>&quot;</code><br />
<code>#include &lt;assert.h&gt;</code><br />
<code>#include &lt;ctype.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:afd2d98a91db062a98a8c1ead9031c478"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parse_8c.html#afd2d98a91db062a98a8c1ead9031c478">CHECK_INDEX</a>(ndx,  n)</td></tr>
<tr class="memdesc:afd2d98a91db062a98a8c1ead9031c478"><td class="mdescLeft">&#160;</td><td class="mdescRight">Abort if index is out of bounds.  <a href="#afd2d98a91db062a98a8c1ead9031c478">More...</a><br /></td></tr>
<tr class="separator:afd2d98a91db062a98a8c1ead9031c478"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9c5014ceaff6e26fa313e6d4f0972ff"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parse_8c.html#af9c5014ceaff6e26fa313e6d4f0972ff">ILLEGAL_INPUT</a>(x)</td></tr>
<tr class="memdesc:af9c5014ceaff6e26fa313e6d4f0972ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Abort with an error message about illegal input.  <a href="#af9c5014ceaff6e26fa313e6d4f0972ff">More...</a><br /></td></tr>
<tr class="separator:af9c5014ceaff6e26fa313e6d4f0972ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a3a023c0c27667e78ae521eb64f1c7c81"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parse_8c.html#a3a023c0c27667e78ae521eb64f1c7c81">ParamType</a> { <b>TwoN</b>, 
<b>Time</b>, 
<b>MixFrac</b>
 }<tr class="memdesc:a3a023c0c27667e78ae521eb64f1c7c81"><td class="mdescLeft">&#160;</td><td class="mdescRight">Distinguish between parameters that describe population size, time, and gene flow.  <a href="parse_8c.html#a3a023c0c27667e78ae521eb64f1c7c81">More...</a><br /></td></tr>
</td></tr>
<tr class="separator:a3a023c0c27667e78ae521eb64f1c7c81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6eb82415a217ada8af68d71a56d03e2"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parse_8c.html#aa6eb82415a217ada8af68d71a56d03e2">ParamStatus</a> { <b>Free</b>, 
<b>Fixed</b>, 
<b>Gaussian</b>
 }<tr class="memdesc:aa6eb82415a217ada8af68d71a56d03e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Distinguish between parameters that free, fixed, and Gaussian.  <a href="parse_8c.html#aa6eb82415a217ada8af68d71a56d03e2">More...</a><br /></td></tr>
</td></tr>
<tr class="separator:aa6eb82415a217ada8af68d71a56d03e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a55c164874ef023c52713ea2d56f189ec"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parse_8c.html#a55c164874ef023c52713ea2d56f189ec">getDbl</a> (double *x, <a class="el" href="struct_tokenizer.html">Tokenizer</a> *tkz, int i)</td></tr>
<tr class="memdesc:a55c164874ef023c52713ea2d56f189ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interpret token i as a double.  <a href="#a55c164874ef023c52713ea2d56f189ec">More...</a><br /></td></tr>
<tr class="separator:a55c164874ef023c52713ea2d56f189ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a639e7f9b5d6a8ebbf0ebb707c8bb90d8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parse_8c.html#a639e7f9b5d6a8ebbf0ebb707c8bb90d8">getULong</a> (unsigned long *x, <a class="el" href="struct_tokenizer.html">Tokenizer</a> *tkz, int i)</td></tr>
<tr class="memdesc:a639e7f9b5d6a8ebbf0ebb707c8bb90d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interpret token i as an unsigned long integer.  <a href="#a639e7f9b5d6a8ebbf0ebb707c8bb90d8">More...</a><br /></td></tr>
<tr class="separator:a639e7f9b5d6a8ebbf0ebb707c8bb90d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed409f962448c235d90f087101f7d0b9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parse_8c.html#aed409f962448c235d90f087101f7d0b9">parseParam</a> (<a class="el" href="struct_tokenizer.html">Tokenizer</a> *tkz, enum <a class="el" href="parse_8c.html#a3a023c0c27667e78ae521eb64f1c7c81">ParamType</a> type, <a class="el" href="struct_par_store.html">ParStore</a> *parstore, <a class="el" href="struct_bounds.html">Bounds</a> *bnd)</td></tr>
<tr class="memdesc:aed409f962448c235d90f087101f7d0b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse a line of input defining a parameter.  <a href="#aed409f962448c235d90f087101f7d0b9">More...</a><br /></td></tr>
<tr class="separator:aed409f962448c235d90f087101f7d0b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb861c0053c16210bdb3434df5a18e1a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parse_8c.html#afb861c0053c16210bdb3434df5a18e1a">parseSegment</a> (<a class="el" href="struct_tokenizer.html">Tokenizer</a> *tkz, <a class="el" href="struct_pop_node_tab.html">PopNodeTab</a> *poptbl, <a class="el" href="struct_samp_ndx.html">SampNdx</a> *sndx, <a class="el" href="struct_lbl_ndx.html">LblNdx</a> *lndx, <a class="el" href="struct_par_store.html">ParStore</a> *parstore, <a class="el" href="struct_node_store.html">NodeStore</a> *ns)</td></tr>
<tr class="memdesc:afb861c0053c16210bdb3434df5a18e1a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse a line describing a segment of the population tree.  <a href="#afb861c0053c16210bdb3434df5a18e1a">More...</a><br /></td></tr>
<tr class="separator:afb861c0053c16210bdb3434df5a18e1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46bdbc850a5f9b6de6cac43bce5ec7f3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parse_8c.html#a46bdbc850a5f9b6de6cac43bce5ec7f3">parseDerive</a> (<a class="el" href="struct_tokenizer.html">Tokenizer</a> *tkz, <a class="el" href="struct_pop_node_tab.html">PopNodeTab</a> *poptbl)</td></tr>
<tr class="memdesc:a46bdbc850a5f9b6de6cac43bce5ec7f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse a line of input describing a parent-offspring relationship between two nodes.  <a href="#a46bdbc850a5f9b6de6cac43bce5ec7f3">More...</a><br /></td></tr>
<tr class="separator:a46bdbc850a5f9b6de6cac43bce5ec7f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e66ac8c87432cfb59bb9f9881668892"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parse_8c.html#a3e66ac8c87432cfb59bb9f9881668892">parseMix</a> (<a class="el" href="struct_tokenizer.html">Tokenizer</a> *tkz, <a class="el" href="struct_pop_node_tab.html">PopNodeTab</a> *poptbl, <a class="el" href="struct_par_store.html">ParStore</a> *parstore)</td></tr>
<tr class="memdesc:a3e66ac8c87432cfb59bb9f9881668892"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse a line of input describing gene flow.  <a href="#a3e66ac8c87432cfb59bb9f9881668892">More...</a><br /></td></tr>
<tr class="separator:a3e66ac8c87432cfb59bb9f9881668892"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11cf54785343d7a98dfc55e6ef1d4d7f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_pop_node.html">PopNode</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parse_8c.html#a11cf54785343d7a98dfc55e6ef1d4d7f">mktree</a> (FILE *fp, <a class="el" href="struct_samp_ndx.html">SampNdx</a> *sndx, <a class="el" href="struct_lbl_ndx.html">LblNdx</a> *lndx, <a class="el" href="struct_par_store.html">ParStore</a> *parstore, <a class="el" href="struct_bounds.html">Bounds</a> *bnd, <a class="el" href="struct_node_store.html">NodeStore</a> *ns)</td></tr>
<tr class="memdesc:a11cf54785343d7a98dfc55e6ef1d4d7f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse an input file in .lgo format.  <a href="#a11cf54785343d7a98dfc55e6ef1d4d7f">More...</a><br /></td></tr>
<tr class="separator:a11cf54785343d7a98dfc55e6ef1d4d7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0c365f8ca3def04d05c614325464e4a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af0c365f8ca3def04d05c614325464e4a"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parse_8c.html#af0c365f8ca3def04d05c614325464e4a">countSegments</a> (FILE *fp)</td></tr>
<tr class="memdesc:af0c365f8ca3def04d05c614325464e4a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Count the number of "segment" statements in input file. <br /></td></tr>
<tr class="separator:af0c365f8ca3def04d05c614325464e4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Parse a .lgo file. </p>
<dl class="section author"><dt>Author</dt><dd>Alan R. Rogers</dd></dl>
<p>Consider the following tree of populations: </p><pre class="fragment"> a-------|
         |ab--|
 b--|bb--|    |
    |         |abc--
    |c--------|
</pre><p>t = 0 1 3 5.5 inf</p>
<p>In this tree, a, b, c, bb, ab, and abc represent segments of the population tree. The input file begins with a series of "segment" statements that define each of the segments in the tree. The segment statements also provide the time (backwards from the present) at which the segment starts, and the size, twoN, of the population. Optionally, it also provides the number of haploid samples observed in this segment of the tree.</p>
<p>The statements that follow the segment statements describe how the segments are connected. The "mix" statement is used when a segment originates as a mixture of two ancestral segments. The "derive" statement is used when a segment derives from a single ancestral segment.</p>
<p>No segment can have more than two "parents" or more than two "children".</p>
<p>Here is input that would generate the tree above:</p>
<p>time fixed T0=0 time free Tc=1 time free Tab=3 time free Tabc=5.5 twoN free 2Na=100 twoN fixed 2Nb=123 twoN free 2Nc=213.4 twoN fixed 2Nbb=32.1 twoN free 2Nab=222 twoN fixed 2Nabc=1.2e2 mixFrac free Mc=0.8 segment a t=T0 twoN=2Na samples=1 segment b t=T0 twoN=2Nb samples=2 segment c t=Tc twoN=2Nc samples=1 segment bb t=Tc twoN=2Nbb segment ab t=Tab twoN=2Nab segment abc t=Tabc twoN=2Nabc mix b from bb + Mc * c derive a from ab derive bb from ab derive ab from abc derive c from abc</p>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright (c) 2016, Alan R. Rogers <a href="#" onclick="location.href='mai'+'lto:'+'rog'+'er'+'s@a'+'nt'+'hro'+'.u'+'tah'+'.e'+'du'; return false;">roger<span style="display: none;">.nosp@m.</span>s@an<span style="display: none;">.nosp@m.</span>thro.<span style="display: none;">.nosp@m.</span>utah<span style="display: none;">.nosp@m.</span>.edu</a>. This file is released under the Internet Systems Consortium License, which can be found in file "LICENSE". </dd></dl>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="afd2d98a91db062a98a8c1ead9031c478"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CHECK_INDEX</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ndx, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">n&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">do</span>{                                \</div><div class="line">        if((ndx)&gt;=(n)){                                         \</div><div class="line">            fprintf(stderr,<span class="stringliteral">&quot;%s:%s:%d: index out of bounds\n&quot;</span>,   \</div><div class="line">                    __FILE__,__func__,__LINE__);                \</div><div class="line">            exit(EXIT_FAILURE);                                 \</div><div class="line">        }                                                       \</div><div class="line">    }<span class="keywordflow">while</span>(0)</div></div><!-- fragment -->
<p>Abort if index is out of bounds. </p>

<p>Referenced by <a class="el" href="parse_8c.html#a46bdbc850a5f9b6de6cac43bce5ec7f3">parseDerive()</a>, <a class="el" href="parse_8c.html#a3e66ac8c87432cfb59bb9f9881668892">parseMix()</a>, <a class="el" href="parse_8c.html#aed409f962448c235d90f087101f7d0b9">parseParam()</a>, and <a class="el" href="parse_8c.html#afb861c0053c16210bdb3434df5a18e1a">parseSegment()</a>.</p>

</div>
</div>
<a class="anchor" id="af9c5014ceaff6e26fa313e6d4f0972ff"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ILLEGAL_INPUT</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">do</span>{                                    \</div><div class="line">        fprintf(stderr,<span class="stringliteral">&quot;%s:%s:%d: Illegal input: \&quot;%s\&quot;\n&quot;</span>,     \</div><div class="line">            __FILE__,__func__,__LINE__, (x));                   \</div><div class="line">        exit(EXIT_FAILURE);                                     \</div><div class="line">    }<span class="keywordflow">while</span>(0)</div></div><!-- fragment -->
<p>Abort with an error message about illegal input. </p>

<p>Referenced by <a class="el" href="parse_8c.html#a11cf54785343d7a98dfc55e6ef1d4d7f">mktree()</a>.</p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a class="anchor" id="aa6eb82415a217ada8af68d71a56d03e2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="parse_8c.html#aa6eb82415a217ada8af68d71a56d03e2">ParamStatus</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Distinguish between parameters that free, fixed, and Gaussian. </p>
<p>Free parameters can be changed during optimization; fixed ones never change; Gaussian ones are reset for each simulation replicate by sampling from a truncated normal distribution. </p>

</div>
</div>
<a class="anchor" id="a3a023c0c27667e78ae521eb64f1c7c81"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="parse_8c.html#a3a023c0c27667e78ae521eb64f1c7c81">ParamType</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Distinguish between parameters that describe population size, time, and gene flow. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a55c164874ef023c52713ea2d56f189ec"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int getDbl </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_tokenizer.html">Tokenizer</a> *&#160;</td>
          <td class="paramname"><em>tkz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Interpret token i as a double. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">x</td><td>points to variable into which double value will be placed </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tkz</td><td>points to <a class="el" href="struct_tokenizer.html">Tokenizer</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i</td><td>index of token to be interpreted as a double </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="tokenizer_8c.html#a44f946e9abb35171c137c87fad9820c4">Tokenizer_token()</a>.</p>

<p>Referenced by <a class="el" href="parse_8c.html#aed409f962448c235d90f087101f7d0b9">parseParam()</a>.</p>

</div>
</div>
<a class="anchor" id="a639e7f9b5d6a8ebbf0ebb707c8bb90d8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int getULong </td>
          <td>(</td>
          <td class="paramtype">unsigned long *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_tokenizer.html">Tokenizer</a> *&#160;</td>
          <td class="paramname"><em>tkz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Interpret token i as an unsigned long integer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">x</td><td>points to variable into which value will be placed </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tkz</td><td>points to <a class="el" href="struct_tokenizer.html">Tokenizer</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i</td><td>index of token to be interpreted as an unsigned long integer. </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="tokenizer_8c.html#a44f946e9abb35171c137c87fad9820c4">Tokenizer_token()</a>.</p>

<p>Referenced by <a class="el" href="parse_8c.html#afb861c0053c16210bdb3434df5a18e1a">parseSegment()</a>.</p>

</div>
</div>
<a class="anchor" id="a11cf54785343d7a98dfc55e6ef1d4d7f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_pop_node.html">PopNode</a>* mktree </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_samp_ndx.html">SampNdx</a> *&#160;</td>
          <td class="paramname"><em>sndx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_lbl_ndx.html">LblNdx</a> *&#160;</td>
          <td class="paramname"><em>lndx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_par_store.html">ParStore</a> *&#160;</td>
          <td class="paramname"><em>parstore</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_bounds.html">Bounds</a> *&#160;</td>
          <td class="paramname"><em>bnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_node_store.html">NodeStore</a> *&#160;</td>
          <td class="paramname"><em>ns</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parse an input file in .lgo format. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fp</td><td>input file pointer </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">sndx</td><td>associates the index of each sample with the <a class="el" href="struct_pop_node.html">PopNode</a> object to which it belongs. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">lndx</td><td>associated index of each sample with its name </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">parstore</td><td>structure that maintains info about parameters </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bnd</td><td>the bounds of each type of parameter </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ns</td><td>allocates <a class="el" href="struct_pop_node.html">PopNode</a> objects </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="misc_8c.html#a1f2415ec1f22a3a73f7702c0143d9402">eprintf()</a>, <a class="el" href="parse_8c.html#af9c5014ceaff6e26fa313e6d4f0972ff">ILLEGAL_INPUT</a>, <a class="el" href="parse_8c.html#a46bdbc850a5f9b6de6cac43bce5ec7f3">parseDerive()</a>, <a class="el" href="parse_8c.html#a3e66ac8c87432cfb59bb9f9881668892">parseMix()</a>, <a class="el" href="parse_8c.html#aed409f962448c235d90f087101f7d0b9">parseParam()</a>, <a class="el" href="parse_8c.html#afb861c0053c16210bdb3434df5a18e1a">parseSegment()</a>, <a class="el" href="popnodetab_8c.html#aea25fd35ea4ace0acdbb11403d2355d3">PopNodeTab_check_and_root()</a>, <a class="el" href="popnodetab_8c.html#a1ca86b06442ba5931c6f0582ebfb2ccc">PopNodeTab_free()</a>, <a class="el" href="popnodetab_8c.html#a17f592b77e7f4733aa3a8e535a1c6c18">PopNodeTab_new()</a>, <a class="el" href="tokenizer_8c.html#adb9007f2fd938123bafee4ae8f30549d">Tokenizer_free()</a>, <a class="el" href="tokenizer_8c.html#a7d509009afe4ef03674efc01336c7257">Tokenizer_new()</a>, <a class="el" href="tokenizer_8c.html#aeedc80b92256e157dfcb0fe6a401e1a7">Tokenizer_split()</a>, <a class="el" href="tokenizer_8c.html#ad89701d3d4406a68fb5f57e4520a789b">Tokenizer_strip()</a>, and <a class="el" href="tokenizer_8c.html#a44f946e9abb35171c137c87fad9820c4">Tokenizer_token()</a>.</p>

<p>Referenced by <a class="el" href="parse_8c.html#af0c365f8ca3def04d05c614325464e4a">countSegments()</a>, and <a class="el" href="gptree_8c.html#ae5af677600280c92025347233baa38af">GPTree_new()</a>.</p>

</div>
</div>
<a class="anchor" id="a46bdbc850a5f9b6de6cac43bce5ec7f3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void parseDerive </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_tokenizer.html">Tokenizer</a> *&#160;</td>
          <td class="paramname"><em>tkz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_pop_node_tab.html">PopNodeTab</a> *&#160;</td>
          <td class="paramname"><em>poptbl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parse a line of input describing a parent-offspring relationship between two nodes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tkz</td><td>the <a class="el" href="struct_tokenizer.html">Tokenizer</a> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">poptbl</td><td>associates names of segments with pointers to them. </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="parse_8c.html#afd2d98a91db062a98a8c1ead9031c478">CHECK_INDEX</a>, <a class="el" href="misc_8c.html#a1f2415ec1f22a3a73f7702c0143d9402">eprintf()</a>, <a class="el" href="popnode_8c.html#af039f9acdd8aee304d861eb7488e08ab">PopNode_addChild()</a>, <a class="el" href="popnodetab_8c.html#af3bb5f8e0cfa89a0e858562b904358f6">PopNodeTab_get()</a>, <a class="el" href="tokenizer_8c.html#a49055f5a86c2b0f1a4d83b36519500e5">Tokenizer_ntokens()</a>, <a class="el" href="tokenizer_8c.html#a6f863b84319366c51ad658c7e4aeb8f1">Tokenizer_print()</a>, and <a class="el" href="tokenizer_8c.html#a44f946e9abb35171c137c87fad9820c4">Tokenizer_token()</a>.</p>

<p>Referenced by <a class="el" href="parse_8c.html#a11cf54785343d7a98dfc55e6ef1d4d7f">mktree()</a>.</p>

</div>
</div>
<a class="anchor" id="a3e66ac8c87432cfb59bb9f9881668892"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void parseMix </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_tokenizer.html">Tokenizer</a> *&#160;</td>
          <td class="paramname"><em>tkz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_pop_node_tab.html">PopNodeTab</a> *&#160;</td>
          <td class="paramname"><em>poptbl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_par_store.html">ParStore</a> *&#160;</td>
          <td class="paramname"><em>parstore</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parse a line of input describing gene flow. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tkz</td><td>the <a class="el" href="struct_tokenizer.html">Tokenizer</a> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">poptbl</td><td>associates names of segments with pointers to them. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">parstore</td><td>structure that maintains info about parameters </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="parse_8c.html#afd2d98a91db062a98a8c1ead9031c478">CHECK_INDEX</a>, <a class="el" href="misc_8c.html#a1f2415ec1f22a3a73f7702c0143d9402">eprintf()</a>, <a class="el" href="parstore_8c.html#a1389f2d6415da07bdf1ce6c5fb0b52a8">ParStore_findPtr()</a>, <a class="el" href="popnode_8c.html#ae6bd97ddbb6bbf3f7dd6fe095c05e783">PopNode_mix()</a>, <a class="el" href="popnodetab_8c.html#af3bb5f8e0cfa89a0e858562b904358f6">PopNodeTab_get()</a>, <a class="el" href="tokenizer_8c.html#a49055f5a86c2b0f1a4d83b36519500e5">Tokenizer_ntokens()</a>, <a class="el" href="tokenizer_8c.html#a6f863b84319366c51ad658c7e4aeb8f1">Tokenizer_print()</a>, and <a class="el" href="tokenizer_8c.html#a44f946e9abb35171c137c87fad9820c4">Tokenizer_token()</a>.</p>

<p>Referenced by <a class="el" href="parse_8c.html#a11cf54785343d7a98dfc55e6ef1d4d7f">mktree()</a>.</p>

</div>
</div>
<a class="anchor" id="aed409f962448c235d90f087101f7d0b9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void parseParam </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_tokenizer.html">Tokenizer</a> *&#160;</td>
          <td class="paramname"><em>tkz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="parse_8c.html#a3a023c0c27667e78ae521eb64f1c7c81">ParamType</a>&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_par_store.html">ParStore</a> *&#160;</td>
          <td class="paramname"><em>parstore</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_bounds.html">Bounds</a> *&#160;</td>
          <td class="paramname"><em>bnd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parse a line of input defining a parameter. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tkz</td><td>the <a class="el" href="struct_tokenizer.html">Tokenizer</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">type</td><td>the type of the current parameter: TwoN, Time, or MixFrac </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">parstore</td><td>structure that maintains info about parameters </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bnd</td><td>the bounds of each type of parameter </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="parse_8c.html#afd2d98a91db062a98a8c1ead9031c478">CHECK_INDEX</a>, <a class="el" href="misc_8c.html#a1f2415ec1f22a3a73f7702c0143d9402">eprintf()</a>, <a class="el" href="parse_8c.html#a55c164874ef023c52713ea2d56f189ec">getDbl()</a>, <a class="el" href="parstore_8c.html#a479a1a5688c93b1df3438881e292e91b">ParStore_addFixedPar()</a>, <a class="el" href="parstore_8c.html#a71840d9452f9537466e8ade1d30825e2">ParStore_addFreePar()</a>, <a class="el" href="parstore_8c.html#ac8ea65d6e012973e92bcce2674eb0636">ParStore_addGaussianPar()</a>, <a class="el" href="tokenizer_8c.html#a49055f5a86c2b0f1a4d83b36519500e5">Tokenizer_ntokens()</a>, <a class="el" href="tokenizer_8c.html#a6f863b84319366c51ad658c7e4aeb8f1">Tokenizer_print()</a>, and <a class="el" href="tokenizer_8c.html#a44f946e9abb35171c137c87fad9820c4">Tokenizer_token()</a>.</p>

<p>Referenced by <a class="el" href="parse_8c.html#a11cf54785343d7a98dfc55e6ef1d4d7f">mktree()</a>.</p>

</div>
</div>
<a class="anchor" id="afb861c0053c16210bdb3434df5a18e1a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void parseSegment </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_tokenizer.html">Tokenizer</a> *&#160;</td>
          <td class="paramname"><em>tkz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_pop_node_tab.html">PopNodeTab</a> *&#160;</td>
          <td class="paramname"><em>poptbl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_samp_ndx.html">SampNdx</a> *&#160;</td>
          <td class="paramname"><em>sndx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_lbl_ndx.html">LblNdx</a> *&#160;</td>
          <td class="paramname"><em>lndx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_par_store.html">ParStore</a> *&#160;</td>
          <td class="paramname"><em>parstore</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_node_store.html">NodeStore</a> *&#160;</td>
          <td class="paramname"><em>ns</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parse a line describing a segment of the population tree. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tkz</td><td>the <a class="el" href="struct_tokenizer.html">Tokenizer</a> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">poptbl</td><td>associates names of segments with pointers to them. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">sndx</td><td>associates the index of each sample with the <a class="el" href="struct_pop_node.html">PopNode</a> object to which it belongs. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">lndx</td><td>associated index of each sample with its name </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">parstore</td><td>structure that maintains info about parameters </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ns</td><td>allocates <a class="el" href="struct_pop_node.html">PopNode</a> objects </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="parse_8c.html#afd2d98a91db062a98a8c1ead9031c478">CHECK_INDEX</a>, <a class="el" href="misc_8c.html#a1f2415ec1f22a3a73f7702c0143d9402">eprintf()</a>, <a class="el" href="parse_8c.html#a639e7f9b5d6a8ebbf0ebb707c8bb90d8">getULong()</a>, <a class="el" href="lblndx_8c.html#a1c29b9b02edd6f2ef227a668eb6c6b49">LblNdx_addSamples()</a>, <a class="el" href="parstore_8c.html#a1389f2d6415da07bdf1ce6c5fb0b52a8">ParStore_findPtr()</a>, <a class="el" href="popnode_8c.html#a243771d5d518c1a0fcc0487e5f06df51">PopNode_new()</a>, <a class="el" href="popnodetab_8c.html#ace350093621a4be89894963fa68468c0">PopNodeTab_insert()</a>, <a class="el" href="popnode_8c.html#ae747836810afb30f2a615c9a4c692b77">SampNdx_addSamples()</a>, <a class="el" href="tokenizer_8c.html#a49055f5a86c2b0f1a4d83b36519500e5">Tokenizer_ntokens()</a>, <a class="el" href="tokenizer_8c.html#a6f863b84319366c51ad658c7e4aeb8f1">Tokenizer_print()</a>, and <a class="el" href="tokenizer_8c.html#a44f946e9abb35171c137c87fad9820c4">Tokenizer_token()</a>.</p>

<p>Referenced by <a class="el" href="parse_8c.html#a11cf54785343d7a98dfc55e6ef1d4d7f">mktree()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Dec 31 2016 17:48:09 for lego by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
